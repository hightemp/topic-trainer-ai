# Topic Trainer AI

SPA приложение для обучения и тренировки знаний с использованием искусственного интеллекта. Приложение позволяет генерировать вопросы по заданным темам, проходить тестирование с использованием интервального повторения и получать обратную связь от AI.

## Технический стек

- **Framework**: Vue 3 (Composition API, `<script setup>`)
- **Language**: TypeScript
- **Build Tool**: Vite
- **State Management**: Pinia
- **Routing**: Vue Router
- **Styling**: CSS / SCSS (Scoped styles, CSS Variables)
- **Persistence**: IndexedDB (через `idb`) для хранения вопросов, истории и настроек локально в браузере.
- **AI Integration**: OpenRouter API (поддержка различных моделей).
- **Deployment**: GitHub Pages (папка `docs`).

## Архитектура данных

### Сущности

1.  **Category (Категория)**
    - `id`: string (uuid)
    - `name`: string
    - `parentId`: string | null (для иерархии)

2.  **Question (Вопрос)**
    - `id`: string (uuid)
    - `text`: string (Markdown)
    - `correctAnswer`: string (Markdown)
    - `difficulty`: number (1-5)
    - `tags`: string[]
    - `categoryId`: string
    - `nextReviewDate`: number (timestamp) - для интервального повторения
    - `interval`: number - текущий интервал в днях
    - `repetitionFactor`: number - E-factor (SM-2 алгоритм)

3.  **Attempt (Попытка/История)**
    - `id`: string
    - `questionId`: string
    - `date`: number (timestamp)
    - `userAnswer`: string
    - `aiScore`: number (0-10)
    - `aiFeedback`: string
    - `duration`: number (секунды)

4.  **Settings (Настройки)**
    - `openRouterKey`: string
    - `openRouterModel`: string (default: "google/gemini-2.0-flash-exp" или другая дешевая/бесплатная)
    - `userName`: string

## Функциональные модули

1.  **Настройки (Settings)**
    - Ввод и сохранение API ключа OpenRouter.
    - Выбор модели.
    - Управление данными (экспорт/импорт JSON).

2.  **Генератор (AI Chat)**
    - Чат-интерфейс для общения с AI.
    - Tool calling для создания, редактирования и удаления вопросов/категорий.
    - Возможность остановки генерации.
    - Очистка истории чата.
    - Многострочный ввод сообщений.

3.  **Библиотека (Library)**
    - Просмотр дерева категорий (с возможностью изменения ширины панели).
    - Фильтрация категорий и вопросов (поиск).
    - CRUD операции для вопросов и категорий.
    - Drag & Drop для перемещения категорий и вопросов.
    - Отображение сложности вопросов с цветовой индикацией.

4.  **Тренировка (Trainer)**
    - Режим настройки тренировки (выбор категорий/тегов).
    - Поддержка выбора корневых категорий (включает все дочерние вопросы).
    - Интерфейс вопроса:
        - Отображение вопроса.
        - Поле ввода ответа (Markdown editor или textarea).
        - Таймер (вкл/выкл).
        - Просмотр списка вопросов текущей сессии (дерево).
    - Проверка ответа:
        - Отправка ответа и правильного ответа в AI.
        - Получение оценки и фидбека.
        - Обновление даты следующего повторения (SM-2).

5.  **Статистика (Stats)**
    - Графики прогресса.
    - История активности с предпросмотром вопросов и ответов.
    - AI анализ слабых мест и советы на основе детальной истории.

## TODO

- [x] **Инициализация проекта**
    - [x] Настроить Vite (build output -> `docs`, base url).
    - [x] Установить Pinia, Vue Router, IDB, Markdown-it.
    - [x] Настроить базовый лейаут (Sidebar/Navigation) и CSS переменные.

- [x] **Базовая логика (Stores & Services)**
    - [x] Создать сервис для работы с IndexedDB.
    - [x] Создать Pinia store для настроек.
    - [x] Создать Pinia store для вопросов и категорий.
    - [x] Реализовать алгоритм интервального повторения (SM-2).

- [x] **Модуль Настроек**
    - [x] Страница настроек (API Key, Model).
    - [x] Экспорт/Импорт данных.

- [x] **Модуль Библиотеки**
    - [x] Компонент дерева категорий.
    - [x] Список вопросов.
    - [x] Форма создания/редактирования вопроса.
    - [x] Drag & Drop (категории и вопросы).
    - [x] Поиск и фильтрация.
    - [x] Ресайз боковой панели.

- [x] **Модуль AI Генерации**
    - [x] Сервис для работы с OpenRouter API.
    - [x] Чат-интерфейс.
    - [x] Реализация "Tools" для AI (CRUD для вопросов и категорий).
    - [x] Остановка генерации и очистка чата.

- [x] **Модуль Тренировки**
    - [x] Экран настройки сессии (выбор тем, включение подкатегорий).
    - [x] Экран вопроса (Вопрос, Ответ, Таймер).
    - [x] Список вопросов сессии.
    - [x] Экран результата (Оценка AI, Фидбек).
    - [x] Логика обновления интервалов повторения.

- [x] **Модуль Статистики**
    - [x] Сбор метрик.
    - [x] Страница статистики с запросом анализа к AI.
    - [x] Детальная история активности.

- [x] **Финальная полировка**
    - [x] Стилизация.
    - [x] Тестирование сборки.