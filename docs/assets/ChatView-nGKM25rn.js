import{c as p,d as I,r as v,l as T,a as n,f as o,g as h,F as k,b,i as y,u as d,w as V,k as B,v as L,o as a,n as S,h as w,t as D,y as H,_ as A}from"./index-DktiZJhq.js";import{a as F,d as N}from"./marked.esm-CWaythUK.js";import{u as U}from"./data-C1Fl07gJ.js";import{v as M}from"./v4-EwEgHOG0.js";const g=p("bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);const q=p("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const Q=p("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);const $=p("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),j={class:"chat-layout"},E={class:"avatar"},P={class:"bubble"},R=["innerHTML"],G={key:1,class:"tool-calls"},J={key:0,class:"message assistant"},K={class:"avatar"},O={class:"bubble loading"},W={class:"input-area"},X=["disabled"],Y=["disabled"],Z=I({__name:"ChatView",setup(ee){const _=U(),l=v([]),r=v(""),i=v(!1),u=v(null);T(()=>{l.value.push({role:"assistant",content:"–ü—Ä–∏–≤–µ—Ç! –Ø –ø–æ–º–æ–≥—É —Å–æ–∑–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏. –ü—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏, –ø–æ –∫–∞–∫–æ–π —Ç–µ–º–µ –Ω—É–∂–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –≤–æ–ø—Ä–æ—Å—ã."})});async function f(){await H(),u.value&&(u.value.scrollTop=u.value.scrollHeight)}async function x(s,t){if(console.log("Tool Call:",s,t),s==="create_category"){const e=M();return await _.addCategory({id:e,name:t.name,parentId:t.parentId||null}),{success:!0,id:e,message:`Category "${t.name}" created.`}}if(s==="create_question"){const e=M();return await _.addQuestion({id:e,text:t.text,correctAnswer:t.correctAnswer,difficulty:t.difficulty,tags:t.tags||[],categoryId:t.categoryId,nextReviewDate:Date.now(),interval:0,repetitionFactor:2.5}),{success:!0,id:e,message:"Question created."}}return s==="get_categories"?_.categories.map(e=>({id:e.id,name:e.name,parentId:e.parentId})):{error:"Unknown tool"}}async function C(){if(!r.value.trim()||i.value)return;const s={role:"user",content:r.value};l.value.push(s),r.value="",i.value=!0,f();try{const t=l.value.map(c=>({role:c.role,content:c.content,tool_calls:c.tool_calls,tool_call_id:c.tool_call_id,name:c.name})),e=await F.chat(t,x);e.content?l.value.push({role:"assistant",content:e.content}):e.tool_calls&&l.value.push({role:"assistant",content:e.content||"–ì–æ—Ç–æ–≤–æ."})}catch(t){l.value.push({role:"assistant",content:`–û—à–∏–±–∫–∞: ${t.message}`})}finally{i.value=!1,f()}}function z(s){return N(s||"")}return(s,t)=>(a(),n("div",j,[o("div",{class:"chat-container",ref_key:"chatContainer",ref:u},[(a(!0),n(k,null,b(l.value,(e,c)=>(a(),n("div",{key:c,class:S(["message",e.role])},[o("div",E,[e.role==="assistant"?(a(),w(d(g),{key:0,size:24})):(a(),w(d($),{key:1,size:24}))]),o("div",P,[e.content?(a(),n("div",{key:0,innerHTML:z(e.content),class:"markdown-content"},null,8,R)):h("",!0),e.tool_calls?(a(),n("div",G,[(a(!0),n(k,null,b(e.tool_calls,m=>(a(),n("div",{key:m.id,class:"tool-badge"}," üõ†Ô∏è "+D(m.function.name),1))),128))])):h("",!0)])],2))),128)),i.value?(a(),n("div",J,[o("div",K,[y(d(g),{size:24})]),o("div",O,[y(d(q),{size:20,class:"spin"})])])):h("",!0)],512),o("div",W,[o("form",{onSubmit:V(C,["prevent"]),class:"input-form"},[B(o("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>r.value=e),type:"text",placeholder:"–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π 5 –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ Vue 3 Composition API...",disabled:i.value},null,8,X),[[L,r.value]]),o("button",{type:"submit",disabled:i.value||!r.value.trim()},[y(d(Q),{size:20})],8,Y)],32)])]))}}),ne=A(Z,[["__scopeId","data-v-4f7639d8"]]);export{ne as default};
