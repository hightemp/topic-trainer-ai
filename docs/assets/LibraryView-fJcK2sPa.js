import{u as U}from"./data-GoCjVp_s.js";import{c as g,d as A,r as b,a as d,F as M,b as V,e as P,o as a,f as e,g as q,h as x,w as C,u as p,t as h,i as y,n as O,_ as D,j as Z,k as $,v as I,s as G,l as J,m as Q,p as S}from"./index-Bwu_TVw9.js";import{v as T}from"./v4-EwEgHOG0.js";const K=g("chevron-down",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const W=g("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const X=g("folder-open",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);const Y=g("folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);const E=g("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);const z=g("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const L=g("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]),ee={class:"tree-list"},te=["onClick"],se=["onClick"],ne={key:1,class:"spacer"},oe={class:"node-name"},ae={class:"actions"},le=["onClick"],ie=["onClick"],de=["onClick"],re={key:0,class:"children"},ue=A({__name:"CategoryTree",props:{nodes:{},selectedId:{}},emits:["select","add","edit","delete"],setup(_,{emit:c}){const m=c,f=b(new Set);function s(v){f.value.has(v)?f.value.delete(v):f.value.add(v)}function r(v){m("select",v)}return(v,l)=>{const n=P("CategoryTree",!0);return a(),d("ul",ee,[(a(!0),d(M,null,V(_.nodes,t=>(a(),d("li",{key:t.id,class:"tree-item"},[e("div",{class:O(["tree-content",{selected:_.selectedId===t.id}]),onClick:u=>r(t.id)},[t.children&&t.children.length>0?(a(),d("button",{key:0,class:"icon-btn toggle-btn",onClick:C(u=>s(t.id),["stop"])},[f.value.has(t.id)?(a(),x(p(K),{key:0,size:16})):(a(),x(p(W),{key:1,size:16}))],8,se)):(a(),d("span",ne)),f.value.has(t.id)?(a(),x(p(X),{key:2,size:18,class:"folder-icon"})):(a(),x(p(Y),{key:3,size:18,class:"folder-icon"})),e("span",oe,h(t.name),1),e("div",ae,[e("button",{class:"icon-btn",onClick:C(u=>m("add",t.id),["stop"]),title:"Add Subcategory"},[y(p(z),{size:14})],8,le),e("button",{class:"icon-btn",onClick:C(u=>m("edit",t),["stop"]),title:"Edit"},[y(p(E),{size:14})],8,ie),e("button",{class:"icon-btn danger",onClick:C(u=>m("delete",t.id),["stop"]),title:"Delete"},[y(p(L),{size:14})],8,de)])],10,te),f.value.has(t.id)&&t.children.length>0?(a(),d("div",re,[y(n,{nodes:t.children,selectedId:_.selectedId,onSelect:l[0]||(l[0]=u=>m("select",u)),onAdd:l[1]||(l[1]=u=>m("add",u)),onEdit:l[2]||(l[2]=u=>m("edit",u)),onDelete:l[3]||(l[3]=u=>m("delete",u))},null,8,["nodes","selectedId"])])):q("",!0)]))),128))])}}}),ce=D(ue,[["__scopeId","data-v-c5424542"]]),ve={class:"editor-card"},me={class:"flex gap-4"},pe={class:"flex-1"},fe={class:"flex-1"},ye={class:"flex justify-end gap-2 mt-4"},ke=A({__name:"QuestionEditor",props:{question:{},categoryId:{}},emits:["save","cancel"],setup(_,{emit:c}){const m=_,f=c,s=b({text:"",correctAnswer:"",difficulty:1,tags:[]}),r=b("");Z(()=>m.question,l=>{l?(s.value={...l},r.value=l.tags.join(", ")):(s.value={text:"",correctAnswer:"",difficulty:1,tags:[]},r.value="")},{immediate:!0});function v(){const l=r.value.split(",").map(t=>t.trim()).filter(t=>t),n={id:s.value.id||T(),text:s.value.text||"",correctAnswer:s.value.correctAnswer||"",difficulty:s.value.difficulty||1,tags:l,categoryId:m.categoryId,nextReviewDate:s.value.nextReviewDate||Date.now(),interval:s.value.interval||0,repetitionFactor:s.value.repetitionFactor||2.5};f("save",n)}return(l,n)=>(a(),d("div",ve,[e("h3",null,h(_.question?"Редактировать вопрос":"Новый вопрос"),1),e("form",{onSubmit:C(v,["prevent"]),class:"flex flex-col gap-4"},[e("div",null,[n[5]||(n[5]=e("label",{class:"block mb-2 font-bold"},"Вопрос (Markdown)",-1)),$(e("textarea",{"onUpdate:modelValue":n[0]||(n[0]=t=>s.value.text=t),rows:"4",required:""},null,512),[[I,s.value.text]])]),e("div",null,[n[6]||(n[6]=e("label",{class:"block mb-2 font-bold"},"Правильный ответ (Markdown)",-1)),$(e("textarea",{"onUpdate:modelValue":n[1]||(n[1]=t=>s.value.correctAnswer=t),rows:"4",required:""},null,512),[[I,s.value.correctAnswer]])]),e("div",me,[e("div",pe,[n[7]||(n[7]=e("label",{class:"block mb-2 font-bold"},"Сложность (1-5)",-1)),$(e("input",{"onUpdate:modelValue":n[2]||(n[2]=t=>s.value.difficulty=t),type:"number",min:"1",max:"5",required:""},null,512),[[I,s.value.difficulty,void 0,{number:!0}]])]),e("div",fe,[n[8]||(n[8]=e("label",{class:"block mb-2 font-bold"},"Теги (через запятую)",-1)),$(e("input",{"onUpdate:modelValue":n[3]||(n[3]=t=>r.value=t),type:"text",placeholder:"js, vue, basics"},null,512),[[I,r.value]])])]),e("div",ye,[e("button",{type:"button",onClick:n[4]||(n[4]=t=>f("cancel"))},"Отмена"),n[9]||(n[9]=e("button",{type:"submit",class:"primary"},"Сохранить",-1))])],32)]))}}),_e=D(ke,[["__scopeId","data-v-12c33e65"]]),he={class:"library-layout"},ge={class:"categories-sidebar"},be={class:"sidebar-header"},Ce={class:"tree-container"},we={class:"questions-main"},xe={key:0},$e={class:"main-header"},Ie={class:"count"},Me={key:0,class:"mt-4"},Ve={key:1,class:"questions-list mt-4"},qe={class:"q-content"},ze={class:"q-text"},Ae={class:"q-meta"},De={class:"badge"},Qe={class:"q-actions"},Se=["onClick"],Te=["onClick"],Ee={key:0,class:"empty-state"},Le={key:1,class:"empty-state-main"},je=A({__name:"LibraryView",setup(_){const c=U(),{categoriesTree:m,questions:f}=G(c),s=b(null),r=b(!1),v=b(null);J(async()=>{c.isLoaded||await c.loadData()});const l=Q(()=>s.value?f.value.filter(o=>o.categoryId===s.value):[]),n=Q(()=>{if(!s.value)return"";const o=c.categories.find(i=>i.id===s.value);return o?o.name:""});function t(o){s.value=o,r.value=!1}async function u(o){const i=prompt("Введите название категории:");i&&await c.addCategory({id:T(),name:i,parentId:o})}async function j(o){const i=prompt("Новое название:",o.name);!i||i===o.name||await c.updateCategory({...o,name:i})}async function F(o){confirm("Удалить категорию и все вложенные вопросы?")&&(await c.removeCategory(o),s.value===o&&(s.value=null))}function H(){v.value=null,r.value=!0}function N(o){v.value=o,r.value=!0}async function R(o){v.value?await c.updateQuestion(o):await c.addQuestion(o),r.value=!1,v.value=null}async function B(o){confirm("Удалить вопрос?")&&await c.removeQuestion(o)}return(o,i)=>(a(),d("div",he,[e("aside",ge,[e("div",be,[i[2]||(i[2]=e("h2",null,"Категории",-1)),e("button",{class:"icon-btn",onClick:i[0]||(i[0]=k=>u(null)),title:"Add Root Category"},[y(p(z),{size:20})])]),e("div",Ce,[y(ce,{nodes:p(m),selectedId:s.value,onSelect:t,onAdd:u,onEdit:j,onDelete:F},null,8,["nodes","selectedId"])])]),e("main",we,[s.value?(a(),d("div",xe,[e("div",$e,[e("h2",null,[S(h(n.value)+" ",1),e("span",Ie,"("+h(l.value.length)+")",1)]),r.value?q("",!0):(a(),d("button",{key:0,class:"primary",onClick:H},[y(p(z),{size:16,style:{"margin-right":"8px"}}),i[3]||(i[3]=S(" Добавить вопрос ",-1))]))]),r.value?(a(),d("div",Me,[y(_e,{question:v.value,categoryId:s.value,onSave:R,onCancel:i[1]||(i[1]=k=>r.value=!1)},null,8,["question","categoryId"])])):(a(),d("div",Ve,[(a(!0),d(M,null,V(l.value,k=>(a(),d("div",{key:k.id,class:"question-card"},[e("div",qe,[e("div",ze,h(k.text),1),e("div",Ae,[e("span",De,"Diff: "+h(k.difficulty),1),(a(!0),d(M,null,V(k.tags,w=>(a(),d("span",{key:w,class:"badge tag"},h(w),1))),128))])]),e("div",Qe,[e("button",{class:"icon-btn",onClick:w=>N(k)},[y(p(E),{size:16})],8,Se),e("button",{class:"icon-btn danger",onClick:w=>B(k.id)},[y(p(L),{size:16})],8,Te)])]))),128)),l.value.length===0?(a(),d("p",Ee," В этой категории пока нет вопросов. ")):q("",!0)]))])):(a(),d("div",Le,[...i[4]||(i[4]=[e("p",null,"Выберите категорию слева, чтобы управлять вопросами.",-1)])]))])]))}}),Re=D(je,[["__scopeId","data-v-5fd9222a"]]);export{Re as default};
